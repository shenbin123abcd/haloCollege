"use strict";!function(){window.app=function(){return{}}()}(),app.index=function(){function t(){a(),i(),l()}function e(t){var e=$.Deferred();return $.ajax({method:"GET",url:"http://college-api.halobear.com/v1/wedding/weddingDetail",data:t,dataType:"jsonp",success:function(t,n,a){1==t.iRet?e.resolve(t.data.detail):e.reject(t.info)},error:function(t,n,a){e.reject("网络繁忙请稍候再试")}}),e.promise()}function n(t){var e=$.Deferred();return $.ajax({method:"GET",url:"http://college-api.halobear.com/v1/wedding/weddingComment",data:t,dataType:"jsonp",success:function(t,n,a){1==t.iRet?e.resolve(t.data):e.reject(t.info)},error:function(t,n,a){e.reject("网络繁忙请稍候再试")}}),e.promise()}function a(){var t=window.location.href.split("=")[1];e({wedding_id:t||1}).then(function(t){t.create_time=1e3*parseInt(t.create_time);var e=c(t.create_time).Y,n=c(t.create_time).M,a=c(t.create_time).D,i="",o="";i='\n\t\t\t\t<div class="title f-19" >'+t.headline+'</div>\n\t\t\t\t<div class="date f-15" >'+e+"年"+n+"月"+a+"日</div>\n\t\t\t",t.imgs&&t.imgs.forEach(function(t,e){o+='\n\t\t\t\t\t\t<img class="lazy" data-original="'+t.url+'" alt="">\n\t\t\t\t\t'}),$("#toutiao-header").empty().html(i),$("#toutiao-content").empty().html(t.content),$("#toutiao-body-pic").empty().html(o),$("#toutiao-brief").empty().text(t.brief),s()},function(t){hb.lib.weui.alert({title:"温馨提示",content:t,btn:"确定"})})}function i(){var t=window.location.href.split("=")[1];n({page:1,per_page:15,wedding_id:t||1}).then(function(t){var e="",n="";t.comment.forEach(function(t,a){t.create_time=1e3*parseInt(t.create_time);c(t.create_time).momentDate;if(console.log(new Date(t.create_time)),t.parent_reply){var i="";t.parent_reply.forEach(function(t,e){t.create_time=1e3*parseInt(t.create_time);c(t.create_time).M,c(t.create_time).D;i+='\n\t\t\t\t\t\t<div class="dialog-content">\n\t\t\t\t\t\t\t<div class="content-top clearfix">\n\t\t\t\t\t\t\t\t<div class="name f-13">'+t.username+'</div>\n\t\t\t\t\t\t\t\t<div class="date f-13">'+moment(t.create_time).fromNow()+'</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="content f-13">'+t.content+'</div>\n\t\t\t\t\t\t\t<img src="__PUBLIC__/Home/Toutiao/images/arrow-128d9093dc.png" alt="" class="img">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t'}),e='\n\t\t\t\t\t<div class="item">\n\t\t\t\t\t\t<div class="comment-item">\n\t\t\t\t\t\t\t<div class="avatar"><img src="'+t.headimg+'" alt=""></div>\n\t\t\t\t\t\t\t<div class="item-content">\n\t\t\t\t\t\t\t\t<div class="name f-16">'+t.username+'</div>\n\t\t\t\t\t\t\t\t<div class="text f-14">'+t.content+"</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t"+i+'\n\t\t\t\t\t\t<div class="comment-bottom f-13 clearfix">\n\t\t\t\t\t\t\t<div class="date">'+moment(t.create_time).fromNow()+'</div>\n\t\t\t\t\t\t\t<div class="message f-13"><span class="haloIcon haloIcon-message f-18" style="position:relative;top:3px;"></span>回复</div>\n\t\t\t\t\t\t\t<div class="remark f-13"><span class="haloIcon haloIcon-great f-18"></span>'+t.count_praise+"</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t"}else e='\n\t\t\t\t\t\t<div class="item">\n\t\t\t\t\t\t\t<div class="comment-item">\n\t\t\t\t\t\t\t\t<div class="avatar"><img src="'+t.headimg+'" alt=""></div>\n\t\t\t\t\t\t\t\t<div class="item-content">\n\t\t\t\t\t\t\t\t\t<div class="name f-16">'+t.username+'</div>\n\t\t\t\t\t\t\t\t\t<div class="text f-14">'+t.content+'</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="comment-bottom f-13 clearfix">\n\t\t\t\t\t\t\t\t<div class="date">'+moment(t.create_time).fromNow()+'</div>\n\t\t\t\t\t\t\t\t<div class="message f-13"><span class="haloIcon haloIcon-message f-18" style="position:relative;top:3px;"></span>回复</div>\n\t\t\t\t\t\t\t\t<div class="remark f-13"><span class="haloIcon haloIcon-great f-18"></span>'+t.count_praise+"</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t";n+=e,$("#comment-list").empty().html(n)})},function(t){$(".comment-block").hide(),hb.lib.weui.alert({title:"温馨提示",content:t,btn:"确定"})})}function o(t){return t<10&&(t="0"+t),t}function c(t){var e=new Date(parseInt(t)),n=o(e.getFullYear()),a=o(e.getMonth()+1),i=o(e.getDate());return{Y:n,M:a,D:i,momentDate:n+a+i}}function s(){$("img.lazy").lazyload({placeholder:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",effect:"fadeIn",failure_limit:100,threshold:200})}function l(){$("#dowload-block").on("click",function(t){t.preventDefault(),window.location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.halobear.weddingvideo"}),$("[close-btn]").on("click",function(t){t.preventDefault(),$("#dowload-block").remove()})}return{init:t}}(),app.wechat=function(){function t(){e.init()}var e={init:function(){var t=this,e=window.appData||{};"undefined"!=typeof e.share&&(this.data.title=e.share.title||this.data.title,this.data.content=e.share.content||this.data.content,this.data.link=e.share.link||this.data.link,this.data.logo=e.share.logo||this.data.logo),$.getScript("http://res.wx.qq.com/open/js/jweixin-1.0.0.js",function(e,n){"success"==n&&t.act()})},data:{title:"2016中国婚礼策划金熊奖",content:"「为你的努力加冕」2016中国婚礼策划师最高奖-金熊奖，2016年度婚礼策划真实作品网络人气票选！",link:"http://wfc.halobear.com/vote/",logo:"http://7ktq5x.com1.z0.glb.clouddn.com/vote_wechat_work.png"},act:function(){var t=this;$.ajax({url:"/vote/getWechat",type:"get",data:{url:encodeURIComponent(window.location.href.split("#")[0])},dataType:"json",success:function(e){wx.config($.extend({jsApiList:["onMenuShareAppMessage","onMenuShareTimeline"]},e)),wx.ready(function(){wx.onMenuShareTimeline({title:t.data.content,desc:"",link:t.data.link,imgUrl:t.data.logo,dataUrl:"",success:function(t){},cancel:function(){}}),wx.onMenuShareAppMessage({title:t.data.title,desc:t.data.content,link:t.data.link,imgUrl:t.data.logo,dataUrl:"",success:function(t){},cancel:function(){}}),wx.onMenuShareQQ({title:t.data.title,desc:t.data.content,link:t.data.link,imgUrl:t.data.logo,dataUrl:"",success:function(t){},cancel:function(){}})})}})},shareCount:function(){}};return{init:t}}();